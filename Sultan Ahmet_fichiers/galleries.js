function __pageX(e){return Modernizr.touchevents?e.originalEvent.touches[0].pageX:e.pageX}function __pageY(e){return Modernizr.touchevents?e.originalEvent.touches[0].pageY:e.pageY}var mouse_initialX,mouse_deltaX,directionX,sections_initial_position,$url,containerWidth,page_bind=!1,treshold_gallery=100;function gallery_ready(){containerWidth=$("#gallery_container").width(),img_loaded=0,$(".arrow_container .arrow_right").bind("click",go_next),$(".arrow_container .arrow_left").bind("click",go_prev),$("#gallery_container .gallery_slider").bind(_mousedown,start_gallery_drag),load_others(),isHandheld?($("#gallery_container .gallery_slider").on("doubletap",function(e){$fullscreen?$fullscreen&&exitFullScreen():launchIntoFullscreen(document.getElementById("gallery_container"))}),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){document.webkitFullscreenElement||document.fullscreenElement||document.msFullscreenElement?($("body").addClass("isFullscreen"),$(window).trigger("resize"),$fullscreen=!0):($("body").removeClass("isFullscreen"),$(window).trigger("resize"),$fullscreen=!1)})):($(window).bind("mousemove",move_arrow),$("#gallery_container .gallery_slider").dblclick(function(){$fullscreen?$fullscreen&&exitFullScreen():launchIntoFullscreen(document.getElementById("gallery_container"))}),$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){document.webkitFullscreenElement||document.fullscreenElement||document.msFullscreenElement?($("#gallery_container .gallery_slider").addClass("no_transform"),$("#main_scroller").addClass("no_transition"),$("body").addClass("isFullscreen"),$fullscreen=!0,setTimeout(function(){$(".drag_icon_label").addClass("no_opacity")},5e3)):($("#gallery_container .gallery_slider").removeClass("no_transform"),$("#main_scroller").removeClass("no_transition"),$("body").removeClass("isFullscreen"),$(".drag_icon_label").removeClass("no_opacity"),$fullscreen=!1)}))}function gallery_resize(){containerWidth=$("#gallery_container").width(),$("#gallery_container .pic_big:not(.active)").addClass("no_transition"),$("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)"),$("#gallery_container .pic_big.active").nextAll().css("transform","translate3d("+containerWidth+"px, 0, 0)"),$("#gallery_container .pic_big.active").prevAll().css("transform","translate3d("+-containerWidth+"px, 0, 0)")}function load_others(){img_loaded++,$(".gallery_slider .pic_big:eq("+img_loaded+") img").is("[data-src]")?($(".gallery_slider .pic_big:eq("+img_loaded+") img").attr("src",$(".gallery_slider .pic_big:eq("+img_loaded+") img").attr("data-src")).removeAttr("data-src"),$(".gallery_slider .pic_big:eq("+img_loaded+") img").imagesLoaded(function(){autosize($(".gallery_slider .pic_big:eq("+img_loaded+") img")),load_others()})):$(".gallery_slider .pic_big:eq("+img_loaded+") img").is("[src]")&&(autosize($(".gallery_slider .pic_big:eq("+img_loaded+") img")),load_others())}var _mousemove,_click,_mouseenter,_mouseleve,_mousedown,_mouseup,galleryReady=!0;function start_gallery_drag(e){isHandheld||e.preventDefault(),galleryReady&&(galleryReady=!1,$(".pic_big").addClass("no_transition"),$(".pic_big.active").css("z-index",1).siblings().css("z-index",2),$(".pic_big.active").nextAll().css("transform","translate3d("+containerWidth+"px, 0, 0)"),$(".pic_big.active").prevAll().css("transform","translate3d("+-containerWidth+"px, 0, 0)"),$(window).bind(_mouseup,stop_gallery_drag),mouse_deltaX=0,mouse_deltaY=0,$("#gallery_container .gallery_slider").bind(_mousemove,move_gallery),mouse_initialX=__pageX(e),mouse_initialY=__pageY(e),initialPageY=pageY,sections_initial_position=0)}function stop_gallery_drag(e){$(window).unbind(_mouseup),$(".pic_big").removeClass("no_transition"),$("#gallery_container .gallery_slider").unbind(_mousemove),$("#gallery_container .gallery_slider").stop(),mouse_deltaX>treshold_gallery&&"left"==directionX&&(0!=$("#gallery_container .pic_big.active").next().length?slide_next():$("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)")),mouse_deltaX>treshold_gallery&&"right"==directionX?0!=$("#gallery_container .pic_big.active").prev().length?slide_prev():$("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)"):mouse_deltaX<treshold_gallery&&($("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)"),$("#gallery_container .pic_big.active").next().css("transform","translate3d("+containerWidth+"px, 0, 0)"),$("#gallery_container .pic_big.active").prev().css("transform","translate3d("+-containerWidth+"px, 0, 0)")),setTimeout(function(){galleryReady=!0},500)}function move_gallery(e){__pageX(e)>mouse_initialX?(mouse_deltaX=__pageX(e)-mouse_initialX,directionX="right"):__pageX(e)<mouse_initialX&&(directionX="left",mouse_deltaX=mouse_initialX-__pageX(e)),__pageY(e)>mouse_initialY&&(mouse_deltaY=__pageY(e)-mouse_initialY,mouse_deltaY<50&&e.preventDefault()),__pageY(e)<mouse_initialY&&(mouse_deltaY=mouse_initialY-__pageY(e),mouse_deltaY<50&&e.preventDefault()),"right"==directionX?(sections_current_position=sections_initial_position+mouse_deltaX,$("#gallery_container .pic_big.active").prev().css("transform","translate3d("+(mouse_deltaX/1.5-containerWidth)+"px, 0, 0)"),$("#gallery_container .pic_big.active").next().css("transform","translate3d("+(containerWidth+mouse_deltaX/1.5)+"px, 0, 0)")):(sections_current_position=sections_initial_position-mouse_deltaX,$("#gallery_container .pic_big.active").next().css("transform","translate3d("+(containerWidth-mouse_deltaX/1.5)+"px, 0, 0)"),$("#gallery_container .pic_big.active").prev().css("transform","translate3d("+(-containerWidth-mouse_deltaX/1.5)+"px, 0, 0)")),$("#gallery_container .pic_big.active").css("transform","translate3d("+sections_current_position/3+"px, 0, 0)")}function slide_next(){0!=$(".gallery_slider .pic_big.active").next().length&&($(".gallery_slider .pic_big.active").css("transform","translate3d("+-containerWidth/3+"px, 0, 0)").removeClass("active").next().addClass("active"),$("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)")),$(".arrow_container .arrow_left").removeClass("no_opacity"),$(".gallery_slider .pic_big.active").index()==$(".gallery_slider .pic_big").length-1&&$(".arrow_container .arrow_right").addClass("no_opacity"),$("#gallery_container .counter").text($(".gallery_slider .pic_big.active").index()+1)}function slide_prev(){0!=$(".gallery_slider .pic_big.active").prev().length&&($(".gallery_slider .pic_big.active").css("transform","translate3d("+containerWidth/3+"px, 0, 0)").removeClass("active").prev().addClass("active"),$("#gallery_container .pic_big.active").css("transform","translate3d(0, 0, 0)")),$(".arrow_container .arrow_right").removeClass("no_opacity"),0==$(".gallery_slider .pic_big.active").index()&&$(".arrow_container .arrow_left").addClass("no_opacity"),$("#gallery_container .counter").text($(".gallery_slider .pic_big.active").index()+1)}function go_next(){galleryReady&&(galleryReady=!1,$(".pic_big").addClass("no_transition"),$(".pic_big.active").css("z-index",1).siblings().css("z-index",2),$(".pic_big.active").nextAll().css("transform","translate3d("+containerWidth+"px, 0, 0)"),$(".pic_big.active").prevAll().css("transform","translate3d("+-containerWidth+"px, 0, 0)"),setTimeout(function(){$(".pic_big").removeClass("no_transition"),slide_next()},20),setTimeout(function(){galleryReady=!0},500))}function go_prev(){galleryReady&&(galleryReady=!1,$(".pic_big").addClass("no_transition"),$(".pic_big.active").css("z-index",1).siblings().css("z-index",2),$(".pic_big.active").nextAll().css("transform","translate3d("+containerWidth+"px, 0, 0)"),$(".pic_big.active").prevAll().css("transform","translate3d("+-containerWidth+"px, 0, 0)"),setTimeout(function(){$(".pic_big").removeClass("no_transition"),slide_prev()},20),setTimeout(function(){galleryReady=!0},500))}function move_arrow(e){$galleryArrow.style[$$transform]="translate3d("+(__pageX(e)-32-$("#gallery_container").offset().left)+"px,"+(__pageY(e)-10-$("#gallery_container").offset().top)+"px, 0)"}$galleryArrow=document.getElementById("gallery_arrow"),jQuery.event.special.doubletap={bindType:"touchend",delegateType:"touchend",handle:function(e){var i=e.handleObj,n=jQuery.data(e.target),t=(new Date).getTime(),l=n.lastTouch?t-n.lastTouch:0,a=null==a?300:a;l<a&&l>30?(n.lastTouch=null,e.type=i.origType,["clientX","clientY","pageX","pageY"].forEach(function(i){e[i]=e.originalEvent.changedTouches[0][i]}),i.handler.apply(this,arguments)):n.lastTouch=t}},Modernizr.touchevents?(_mousemove="touchmove",_click="touchend",_mousedown="touchstart",_mouseup="touchend",_mouseenter="mouseenter",_mouseleave="mouseleave"):(_mousemove="mousemove",_click="click",_mousedown="mousedown",_mouseup="mouseup",_mouseenter="mouseenter",_mouseleave="mouseleave");var $fullscreen=!1;function launchIntoFullscreen(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function exitFullScreen(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}